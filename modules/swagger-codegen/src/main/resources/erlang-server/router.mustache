-module({{packageName}}_router).

-export([get_paths/2]).

get_paths(LogicHandler, SwaggerPath) ->
    ValidatorState = prepare_validator(SwaggerPath),
    [
        {'_',
          [
      {{#apiInfo}}{{#apis}}
        {{#operations}}{{#operation}}
            {"{{path}}", '{{packageName}}_handler', ["{{operationId}}", LogicHandler, ValidatorState]}
        {{#hasMore}},{{/hasMore}}
        {{/operation}}{{#hasMore}},{{/hasMore}}{{/operations}}
    {{/apis}}{{/apiInfo}}
            ]
          }
    ].

prepare_validator(SwaggerPath) ->
    R = jsx:decode(element(2, file:read_file(SwaggerPath))),
    jesse_state:new(R, [{default_schema_ver, <<"http://json-schema.org/draft-04/schema#">>}]).
